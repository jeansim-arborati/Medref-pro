<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="MedRef Pro">
    <meta name="theme-color" content="#0f172a">
    <title>MedRef Pro - Fiches Médicales Professionnelles</title>
    <link rel="manifest" href="manifest.json">
    <link rel="apple-touch-icon" href="icon-192.png">
    
    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=Fraunces:opsz,wght@9..144,400;9..144,600&display=swap" rel="stylesheet">
    
    <style>
        :root {
            /* Couleurs principales - Palette médicale sophistiquée */
            --bg-base: #0f172a;
            --bg-surface: #1e293b;
            --bg-elevated: #334155;
            --bg-card: linear-gradient(145deg, #1e293b 0%, #0f172a 100%);
            --bg-card-hover: linear-gradient(145deg, #334155 0%, #1e293b 100%);
            
            /* Accents */
            --accent-primary: #38bdf8;
            --accent-secondary: #818cf8;
            --accent-tertiary: #34d399;
            --accent-warm: #fb923c;
            --accent-rose: #f472b6;
            
            /* Gradients */
            --gradient-primary: linear-gradient(135deg, #38bdf8 0%, #818cf8 100%);
            --gradient-success: linear-gradient(135deg, #34d399 0%, #22d3ee 100%);
            --gradient-warm: linear-gradient(135deg, #fb923c 0%, #f472b6 100%);
            --gradient-card: linear-gradient(145deg, rgba(56, 189, 248, 0.1) 0%, rgba(129, 140, 248, 0.05) 100%);
            
            /* Texte */
            --text-primary: #f8fafc;
            --text-secondary: #94a3b8;
            --text-muted: #64748b;
            --text-inverse: #0f172a;
            
            /* Bordures & Effets */
            --border-subtle: rgba(148, 163, 184, 0.1);
            --border-accent: rgba(56, 189, 248, 0.3);
            --glow-primary: 0 0 40px rgba(56, 189, 248, 0.15);
            --glow-accent: 0 0 60px rgba(56, 189, 248, 0.2);
            --shadow-card: 0 4px 24px rgba(0, 0, 0, 0.3), 0 1px 2px rgba(0, 0, 0, 0.2);
            --shadow-elevated: 0 12px 48px rgba(0, 0, 0, 0.4);
            
            /* Espacements */
            --space-xs: 4px;
            --space-sm: 8px;
            --space-md: 16px;
            --space-lg: 24px;
            --space-xl: 32px;
            --space-2xl: 48px;
            --space-3xl: 64px;
            
            /* Rayons */
            --radius-sm: 8px;
            --radius-md: 12px;
            --radius-lg: 16px;
            --radius-xl: 24px;
            --radius-full: 9999px;
            
            /* Transitions */
            --transition-fast: 0.15s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-base: 0.25s cubic-bezier(0.4, 0, 0.2, 1);
            --transition-slow: 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            
            /* Safe areas iOS */
            --safe-top: env(safe-area-inset-top);
            --safe-bottom: env(safe-area-inset-bottom);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        html {
            scroll-behavior: smooth;
        }

        body {
            font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
            background: var(--bg-base);
            color: var(--text-primary);
            min-height: 100vh;
            min-height: 100dvh;
            line-height: 1.6;
            overflow-x: hidden;
        }

        /* Scrollbar élégante */
        ::-webkit-scrollbar {
            width: 6px;
            height: 6px;
        }
        ::-webkit-scrollbar-track {
            background: transparent;
        }
        ::-webkit-scrollbar-thumb {
            background: var(--text-muted);
            border-radius: 3px;
        }
        ::-webkit-scrollbar-thumb:hover {
            background: var(--text-secondary);
        }

        /* Selection */
        ::selection {
            background: var(--accent-primary);
            color: var(--text-inverse);
        }

        #root {
            min-height: 100vh;
            min-height: 100dvh;
        }

        /* ============================================
           LAYOUT PRINCIPAL
           ============================================ */
        .app {
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            min-height: 100dvh;
            position: relative;
        }

        /* Background effet */
        .app::before {
            content: '';
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 60vh;
            background: radial-gradient(ellipse 80% 50% at 50% -20%, rgba(56, 189, 248, 0.15) 0%, transparent 70%),
                        radial-gradient(ellipse 60% 40% at 80% 20%, rgba(129, 140, 248, 0.1) 0%, transparent 60%);
            pointer-events: none;
            z-index: 0;
        }

        /* Container responsive */
        .container {
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 var(--space-md);
        }

        @media (min-width: 768px) {
            .container {
                padding: 0 var(--space-xl);
            }
        }

        @media (min-width: 1200px) {
            .container {
                padding: 0 var(--space-2xl);
            }
        }

        /* ============================================
           HEADER
           ============================================ */
        .header {
            position: sticky;
            top: 0;
            z-index: 100;
            padding-top: calc(var(--safe-top) + var(--space-md));
            padding-bottom: var(--space-lg);
            background: linear-gradient(to bottom, 
                var(--bg-base) 0%, 
                var(--bg-base) 60%, 
                rgba(15, 23, 42, 0) 100%);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
        }

        .header-inner {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: var(--space-md);
        }

        .logo {
            display: flex;
            align-items: center;
            gap: var(--space-md);
        }

        .logo-mark {
            width: 48px;
            height: 48px;
            background: var(--gradient-primary);
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: var(--glow-primary);
            position: relative;
            overflow: hidden;
        }

        .logo-mark::after {
            content: '';
            position: absolute;
            inset: 0;
            background: linear-gradient(135deg, rgba(255,255,255,0.2) 0%, transparent 50%);
        }

        .logo-mark svg {
            width: 26px;
            height: 26px;
            color: white;
            position: relative;
            z-index: 1;
        }

        .logo-text {
            display: flex;
            flex-direction: column;
        }

        .logo-title {
            font-family: 'Fraunces', Georgia, serif;
            font-size: 24px;
            font-weight: 600;
            letter-spacing: -0.02em;
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .logo-subtitle {
            font-size: 11px;
            font-weight: 500;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        /* Header Actions */
        .header-actions {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
        }

        .btn-icon {
            width: 44px;
            height: 44px;
            border-radius: var(--radius-md);
            background: var(--bg-surface);
            border: 1px solid var(--border-subtle);
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition-base);
        }

        .btn-icon:hover, .btn-icon:active {
            background: var(--bg-elevated);
            color: var(--text-primary);
            border-color: var(--border-accent);
        }

        .btn-icon svg {
            width: 20px;
            height: 20px;
        }

        /* ============================================
           HERO SECTION
           ============================================ */
        .hero {
            padding: var(--space-lg) 0 var(--space-2xl);
            position: relative;
            z-index: 1;
        }

        .hero-content {
            max-width: 600px;
        }

        .hero-title {
            font-family: 'Fraunces', Georgia, serif;
            font-size: clamp(28px, 5vw, 42px);
            font-weight: 600;
            line-height: 1.2;
            margin-bottom: var(--space-md);
            letter-spacing: -0.02em;
        }

        .hero-title span {
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .hero-description {
            font-size: 16px;
            color: var(--text-secondary);
            margin-bottom: var(--space-xl);
            max-width: 480px;
        }

        /* Search Bar */
        .search-wrapper {
            position: relative;
            max-width: 560px;
        }

        .search-bar {
            width: 100%;
            display: flex;
            align-items: center;
            background: var(--bg-surface);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-lg);
            padding: var(--space-xs);
            transition: var(--transition-base);
            box-shadow: var(--shadow-card);
        }

        .search-bar:focus-within {
            border-color: var(--accent-primary);
            box-shadow: var(--shadow-card), 0 0 0 4px rgba(56, 189, 248, 0.1);
        }

        .search-icon {
            padding: var(--space-md);
            color: var(--text-muted);
        }

        .search-input {
            flex: 1;
            background: none;
            border: none;
            color: var(--text-primary);
            font-size: 16px;
            font-family: inherit;
            padding: var(--space-md) 0;
            outline: none;
        }

        .search-input::placeholder {
            color: var(--text-muted);
        }

        .search-kbd {
            display: none;
            padding: var(--space-xs) var(--space-sm);
            background: var(--bg-elevated);
            border-radius: var(--radius-sm);
            font-size: 12px;
            color: var(--text-muted);
            margin-right: var(--space-md);
        }

        @media (min-width: 768px) {
            .search-kbd {
                display: block;
            }
        }

        /* ============================================
           STATS CARDS
           ============================================ */
        .stats-section {
            padding: var(--space-lg) 0;
            position: relative;
            z-index: 1;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: var(--space-md);
        }

        @media (min-width: 768px) {
            .stats-grid {
                grid-template-columns: repeat(4, 1fr);
            }
        }

        .stat-card {
            background: var(--bg-card);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            position: relative;
            overflow: hidden;
            transition: var(--transition-base);
        }

        .stat-card::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            background: var(--gradient-primary);
            opacity: 0;
            transition: var(--transition-base);
        }

        .stat-card:hover::before {
            opacity: 1;
        }

        .stat-icon {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: var(--space-md);
        }

        .stat-icon.blue { background: rgba(56, 189, 248, 0.15); color: var(--accent-primary); }
        .stat-icon.purple { background: rgba(129, 140, 248, 0.15); color: var(--accent-secondary); }
        .stat-icon.green { background: rgba(52, 211, 153, 0.15); color: var(--accent-tertiary); }
        .stat-icon.orange { background: rgba(251, 146, 60, 0.15); color: var(--accent-warm); }

        .stat-value {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: var(--space-xs);
            background: var(--gradient-primary);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .stat-label {
            font-size: 13px;
            color: var(--text-muted);
            font-weight: 500;
        }

        /* ============================================
           CATEGORIES FILTER
           ============================================ */
        .categories-section {
            padding: var(--space-md) 0;
            position: relative;
            z-index: 1;
        }

        .categories-scroll {
            display: flex;
            gap: var(--space-sm);
            overflow-x: auto;
            padding-bottom: var(--space-md);
            -webkit-overflow-scrolling: touch;
            scrollbar-width: none;
            -ms-overflow-style: none;
        }

        .categories-scroll::-webkit-scrollbar {
            display: none;
        }

        .category-chip {
            flex: 0 0 auto;
            padding: var(--space-sm) var(--space-lg);
            background: var(--bg-surface);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-full);
            color: var(--text-secondary);
            font-size: 14px;
            font-weight: 500;
            font-family: inherit;
            cursor: pointer;
            transition: var(--transition-base);
            white-space: nowrap;
        }

        .category-chip:hover {
            background: var(--bg-elevated);
            color: var(--text-primary);
        }

        .category-chip.active {
            background: var(--gradient-primary);
            border-color: transparent;
            color: var(--text-inverse);
            font-weight: 600;
        }

        /* ============================================
           DISEASE GRID
           ============================================ */
        .diseases-section {
            padding: var(--space-lg) 0 calc(var(--space-3xl) + var(--safe-bottom));
            position: relative;
            z-index: 1;
        }

        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-lg);
        }

        .section-title {
            font-size: 13px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .section-count {
            font-size: 13px;
            color: var(--text-muted);
        }

        .diseases-grid {
            display: grid;
            grid-template-columns: 1fr;
            gap: var(--space-md);
        }

        @media (min-width: 768px) {
            .diseases-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1200px) {
            .diseases-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        /* Disease Card */
        .disease-card {
            background: var(--bg-surface);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            cursor: pointer;
            transition: var(--transition-base);
            position: relative;
            overflow: hidden;
        }

        .disease-card::before {
            content: '';
            position: absolute;
            inset: 0;
            background: var(--gradient-card);
            opacity: 0;
            transition: var(--transition-base);
        }

        .disease-card:hover, .disease-card:active {
            border-color: var(--border-accent);
            transform: translateY(-2px);
            box-shadow: var(--shadow-elevated);
        }

        .disease-card:hover::before {
            opacity: 1;
        }

        .disease-card-content {
            position: relative;
            z-index: 1;
        }

        .disease-header {
            display: flex;
            align-items: flex-start;
            justify-content: space-between;
            gap: var(--space-md);
            margin-bottom: var(--space-md);
        }

        .disease-name {
            font-size: 17px;
            font-weight: 600;
            color: var(--text-primary);
            line-height: 1.3;
        }

        .disease-badge {
            flex-shrink: 0;
            padding: var(--space-xs) var(--space-sm);
            background: rgba(56, 189, 248, 0.1);
            border: 1px solid rgba(56, 189, 248, 0.2);
            border-radius: var(--radius-full);
            font-size: 11px;
            font-weight: 600;
            color: var(--accent-primary);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        .disease-preview {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.6;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            margin-bottom: var(--space-md);
        }

        .disease-footer {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            padding-top: var(--space-md);
            border-top: 1px solid var(--border-subtle);
        }

        .disease-meta {
            display: flex;
            align-items: center;
            gap: var(--space-xs);
            font-size: 12px;
            color: var(--text-muted);
        }

        .disease-meta svg {
            width: 14px;
            height: 14px;
        }

        .disease-status {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: var(--space-xs);
            font-size: 12px;
            font-weight: 500;
        }

        .disease-status.generated {
            color: var(--accent-tertiary);
        }

        .disease-status.pending {
            color: var(--text-muted);
        }

        .status-dot {
            width: 6px;
            height: 6px;
            border-radius: 50%;
            background: currentColor;
        }

        /* ============================================
           DETAIL VIEW (Slide Panel)
           ============================================ */
        .detail-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.6);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            z-index: 200;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition-base);
        }

        .detail-overlay.open {
            opacity: 1;
            visibility: visible;
        }

        .detail-panel {
            position: fixed;
            top: 0;
            right: 0;
            bottom: 0;
            width: 100%;
            max-width: 640px;
            background: var(--bg-base);
            z-index: 201;
            transform: translateX(100%);
            transition: transform 0.4s cubic-bezier(0.32, 0.72, 0, 1);
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        .detail-panel.open {
            transform: translateX(0);
        }

        @media (min-width: 768px) {
            .detail-panel {
                border-left: 1px solid var(--border-subtle);
                box-shadow: -20px 0 60px rgba(0, 0, 0, 0.3);
            }
        }

        .detail-header {
            padding: calc(var(--safe-top) + var(--space-lg)) var(--space-lg) var(--space-lg);
            background: linear-gradient(to bottom, var(--bg-base) 0%, var(--bg-base) 80%, transparent 100%);
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .detail-nav {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-lg);
        }

        .btn-back {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            background: none;
            border: none;
            color: var(--accent-primary);
            font-size: 15px;
            font-weight: 500;
            font-family: inherit;
            cursor: pointer;
            padding: var(--space-sm) 0;
            transition: var(--transition-fast);
        }

        .btn-back:hover {
            opacity: 0.8;
        }

        .btn-back svg {
            width: 20px;
            height: 20px;
        }

        .btn-refresh {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            background: var(--bg-surface);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-md);
            color: var(--text-secondary);
            font-size: 13px;
            font-weight: 500;
            font-family: inherit;
            padding: var(--space-sm) var(--space-md);
            cursor: pointer;
            transition: var(--transition-base);
        }

        .btn-refresh:hover {
            background: var(--bg-elevated);
            color: var(--text-primary);
        }

        .btn-refresh svg {
            width: 16px;
            height: 16px;
        }

        .detail-title {
            font-family: 'Fraunces', Georgia, serif;
            font-size: clamp(24px, 5vw, 32px);
            font-weight: 600;
            line-height: 1.2;
            margin-bottom: var(--space-sm);
            letter-spacing: -0.02em;
        }

        .detail-badge {
            display: inline-flex;
            padding: var(--space-xs) var(--space-md);
            background: rgba(56, 189, 248, 0.1);
            border: 1px solid rgba(56, 189, 248, 0.2);
            border-radius: var(--radius-full);
            font-size: 12px;
            font-weight: 600;
            color: var(--accent-primary);
        }

        .detail-content {
            flex: 1;
            overflow-y: auto;
            padding: 0 var(--space-lg) calc(var(--space-2xl) + var(--safe-bottom));
            -webkit-overflow-scrolling: touch;
        }

        /* Info Cards dans Detail */
        .info-card {
            background: var(--bg-surface);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            margin-bottom: var(--space-md);
            position: relative;
            overflow: hidden;
        }

        .info-card::before {
            content: '';
            position: absolute;
            left: 0;
            top: 0;
            bottom: 0;
            width: 3px;
        }

        .info-card.blue::before { background: var(--accent-primary); }
        .info-card.purple::before { background: var(--accent-secondary); }
        .info-card.green::before { background: var(--accent-tertiary); }
        .info-card.orange::before { background: var(--accent-warm); }
        .info-card.rose::before { background: var(--accent-rose); }

        .info-card-header {
            display: flex;
            align-items: center;
            gap: var(--space-md);
            margin-bottom: var(--space-md);
        }

        .info-card-icon {
            width: 40px;
            height: 40px;
            border-radius: var(--radius-md);
            display: flex;
            align-items: center;
            justify-content: center;
            flex-shrink: 0;
        }

        .info-card-icon.blue { background: rgba(56, 189, 248, 0.15); color: var(--accent-primary); }
        .info-card-icon.purple { background: rgba(129, 140, 248, 0.15); color: var(--accent-secondary); }
        .info-card-icon.green { background: rgba(52, 211, 153, 0.15); color: var(--accent-tertiary); }
        .info-card-icon.orange { background: rgba(251, 146, 60, 0.15); color: var(--accent-warm); }
        .info-card-icon.rose { background: rgba(244, 114, 182, 0.15); color: var(--accent-rose); }

        .info-card-icon svg {
            width: 20px;
            height: 20px;
        }

        .info-card-title {
            font-size: 11px;
            font-weight: 700;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
        }

        .info-card-body {
            color: var(--text-secondary);
            font-size: 15px;
            line-height: 1.7;
        }

        .info-card-body strong {
            color: var(--text-primary);
            font-weight: 600;
        }

        .info-card-body ul {
            margin: var(--space-md) 0;
            padding-left: var(--space-lg);
        }

        .info-card-body li {
            margin-bottom: var(--space-sm);
        }

        .info-card-body li::marker {
            color: var(--accent-primary);
        }

        /* Epidemiology Grid */
        .epi-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: var(--space-sm);
            margin-bottom: var(--space-md);
        }

        .epi-item {
            background: var(--bg-elevated);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            text-align: center;
        }

        .epi-value {
            font-size: 18px;
            font-weight: 700;
            color: var(--accent-primary);
            margin-bottom: var(--space-xs);
            word-break: break-word;
        }

        .epi-label {
            font-size: 10px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }

        /* Mnemonic Box */
        .mnemonic-box {
            background: linear-gradient(135deg, rgba(129, 140, 248, 0.1) 0%, rgba(56, 189, 248, 0.1) 100%);
            border: 1px solid rgba(129, 140, 248, 0.2);
            border-radius: var(--radius-lg);
            padding: var(--space-lg);
            margin-top: var(--space-md);
        }

        .mnemonic-label {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            font-size: 11px;
            font-weight: 700;
            color: var(--accent-secondary);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: var(--space-sm);
        }

        .mnemonic-label svg {
            width: 16px;
            height: 16px;
        }

        .mnemonic-text {
            font-family: 'Fraunces', Georgia, serif;
            font-size: 20px;
            font-style: italic;
            color: var(--text-primary);
            line-height: 1.4;
            margin-bottom: var(--space-md);
        }

        .mnemonic-explanation {
            font-size: 14px;
            color: var(--text-secondary);
            line-height: 1.6;
        }

        /* Highlight Box */
        .highlight-box {
            background: var(--bg-elevated);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            margin-top: var(--space-md);
        }

        /* Sources */
        .sources-list {
            margin-top: var(--space-md);
            padding-top: var(--space-md);
            border-top: 1px solid var(--border-subtle);
        }

        .sources-title {
            font-size: 11px;
            font-weight: 600;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: var(--space-sm);
        }

        .source-item {
            font-size: 13px;
            color: var(--text-muted);
            margin-bottom: var(--space-xs);
            padding-left: var(--space-md);
            position: relative;
        }

        .source-item::before {
            content: '•';
            position: absolute;
            left: 0;
            color: var(--accent-primary);
        }

        /* ============================================
           SETTINGS MODAL
           ============================================ */
        .settings-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.7);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            z-index: 300;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition-base);
        }

        .settings-overlay.open {
            opacity: 1;
            visibility: visible;
        }

        .settings-modal {
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            max-height: 90vh;
            background: var(--bg-surface);
            border-top-left-radius: var(--radius-xl);
            border-top-right-radius: var(--radius-xl);
            z-index: 301;
            transform: translateY(100%);
            transition: transform 0.4s cubic-bezier(0.32, 0.72, 0, 1);
            overflow: hidden;
            display: flex;
            flex-direction: column;
        }

        .settings-modal.open {
            transform: translateY(0);
        }

        @media (min-width: 768px) {
            .settings-modal {
                top: 50%;
                left: 50%;
                bottom: auto;
                right: auto;
                transform: translate(-50%, -50%) scale(0.95);
                opacity: 0;
                width: 100%;
                max-width: 480px;
                max-height: 80vh;
                border-radius: var(--radius-xl);
            }

            .settings-modal.open {
                transform: translate(-50%, -50%) scale(1);
                opacity: 1;
            }
        }

        .settings-header {
            padding: var(--space-lg);
            border-bottom: 1px solid var(--border-subtle);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .settings-handle {
            display: block;
            width: 36px;
            height: 4px;
            background: var(--text-muted);
            border-radius: 2px;
            margin: 0 auto var(--space-md);
        }

        @media (min-width: 768px) {
            .settings-handle {
                display: none;
            }
        }

        .settings-title {
            font-size: 18px;
            font-weight: 700;
        }

        .btn-close {
            width: 36px;
            height: 36px;
            border-radius: var(--radius-md);
            background: var(--bg-elevated);
            border: none;
            color: var(--text-secondary);
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: var(--transition-fast);
        }

        .btn-close:hover {
            color: var(--text-primary);
        }

        .settings-body {
            flex: 1;
            overflow-y: auto;
            padding: var(--space-lg);
        }

        .setting-group {
            margin-bottom: var(--space-xl);
        }

        .setting-group-title {
            font-size: 11px;
            font-weight: 700;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.1em;
            margin-bottom: var(--space-md);
        }

        .setting-item {
            background: var(--bg-base);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-md);
            padding: var(--space-md);
            margin-bottom: var(--space-sm);
        }

        .setting-item-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: var(--space-sm);
        }

        .setting-label {
            font-size: 15px;
            font-weight: 600;
        }

        .setting-desc {
            font-size: 13px;
            color: var(--text-muted);
            line-height: 1.5;
        }

        .input-field {
            width: 100%;
            padding: var(--space-md);
            background: var(--bg-surface);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-md);
            color: var(--text-primary);
            font-size: 14px;
            font-family: 'SF Mono', Monaco, monospace;
            margin-top: var(--space-sm);
            transition: var(--transition-base);
        }

        .input-field:focus {
            outline: none;
            border-color: var(--accent-primary);
            box-shadow: 0 0 0 4px rgba(56, 189, 248, 0.1);
        }

        .input-field::placeholder {
            color: var(--text-muted);
        }

        .settings-footer {
            padding: var(--space-lg);
            padding-bottom: calc(var(--space-lg) + var(--safe-bottom));
            border-top: 1px solid var(--border-subtle);
        }

        .btn-primary {
            width: 100%;
            padding: var(--space-md) var(--space-xl);
            background: var(--gradient-primary);
            border: none;
            border-radius: var(--radius-md);
            color: var(--text-inverse);
            font-size: 15px;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            transition: var(--transition-base);
            box-shadow: 0 4px 16px rgba(56, 189, 248, 0.3);
        }

        .btn-primary:hover {
            transform: translateY(-1px);
            box-shadow: 0 6px 24px rgba(56, 189, 248, 0.4);
        }

        .btn-primary:active {
            transform: translateY(0);
        }

        .btn-primary:disabled {
            opacity: 0.5;
            cursor: not-allowed;
            transform: none;
        }

        /* Status badges */
        .status-badge {
            display: inline-flex;
            align-items: center;
            gap: var(--space-xs);
            padding: var(--space-xs) var(--space-sm);
            border-radius: var(--radius-full);
            font-size: 12px;
            font-weight: 600;
        }

        .status-badge.success {
            background: rgba(52, 211, 153, 0.15);
            color: var(--accent-tertiary);
        }

        .status-badge.warning {
            background: rgba(251, 146, 60, 0.15);
            color: var(--accent-warm);
        }

        .status-badge.error {
            background: rgba(239, 68, 68, 0.15);
            color: #f87171;
        }

        /* ============================================
           LOADING & STATES
           ============================================ */
        .loading-overlay {
            position: fixed;
            inset: 0;
            background: rgba(15, 23, 42, 0.9);
            backdrop-filter: blur(8px);
            -webkit-backdrop-filter: blur(8px);
            z-index: 400;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            opacity: 0;
            visibility: hidden;
            transition: var(--transition-base);
        }

        .loading-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        .loading-spinner {
            width: 48px;
            height: 48px;
            border: 3px solid var(--border-subtle);
            border-top-color: var(--accent-primary);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin-bottom: var(--space-lg);
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .loading-text {
            font-size: 16px;
            color: var(--text-secondary);
            text-align: center;
        }

        .loading-subtext {
            font-size: 13px;
            color: var(--text-muted);
            margin-top: var(--space-sm);
        }

        /* Progress bar */
        .progress-bar {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 3px;
            z-index: 500;
            overflow: hidden;
            opacity: 0;
            transition: opacity 0.3s;
        }

        .progress-bar.active {
            opacity: 1;
        }

        .progress-bar-inner {
            height: 100%;
            background: var(--gradient-primary);
            animation: progress 2s ease-in-out infinite;
        }

        @keyframes progress {
            0% { transform: translateX(-100%); }
            50% { transform: translateX(0%); }
            100% { transform: translateX(100%); }
        }

        /* Toast */
        .toast {
            position: fixed;
            bottom: calc(var(--space-xl) + var(--safe-bottom));
            left: 50%;
            transform: translateX(-50%) translateY(100px);
            background: var(--bg-elevated);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-md);
            padding: var(--space-md) var(--space-xl);
            color: var(--text-primary);
            font-size: 14px;
            font-weight: 500;
            z-index: 500;
            opacity: 0;
            transition: all 0.3s cubic-bezier(0.32, 0.72, 0, 1);
            box-shadow: var(--shadow-elevated);
            max-width: calc(100vw - var(--space-xl) * 2);
            text-align: center;
        }

        .toast.show {
            opacity: 1;
            transform: translateX(-50%) translateY(0);
        }

        /* Empty State */
        .empty-state {
            text-align: center;
            padding: var(--space-3xl) var(--space-lg);
        }

        .empty-state-icon {
            width: 80px;
            height: 80px;
            margin: 0 auto var(--space-lg);
            background: var(--bg-surface);
            border-radius: var(--radius-xl);
            display: flex;
            align-items: center;
            justify-content: center;
            color: var(--text-muted);
        }

        .empty-state-icon svg {
            width: 40px;
            height: 40px;
        }

        .empty-state-title {
            font-size: 18px;
            font-weight: 600;
            margin-bottom: var(--space-sm);
        }

        .empty-state-desc {
            font-size: 14px;
            color: var(--text-muted);
            max-width: 300px;
            margin: 0 auto var(--space-lg);
        }

        .btn-generate {
            display: inline-flex;
            align-items: center;
            gap: var(--space-sm);
            padding: var(--space-md) var(--space-xl);
            background: var(--gradient-primary);
            border: none;
            border-radius: var(--radius-md);
            color: var(--text-inverse);
            font-size: 15px;
            font-weight: 600;
            font-family: inherit;
            cursor: pointer;
            transition: var(--transition-base);
        }

        .btn-generate:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 24px rgba(56, 189, 248, 0.3);
        }

        .btn-generate svg {
            width: 18px;
            height: 18px;
        }

        /* Update status inline */
        .update-info {
            display: flex;
            align-items: center;
            gap: var(--space-sm);
            padding: var(--space-md);
            background: var(--bg-surface);
            border: 1px solid var(--border-subtle);
            border-radius: var(--radius-md);
            margin-bottom: var(--space-lg);
            font-size: 13px;
            color: var(--text-muted);
        }

        .update-info .dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            background: var(--accent-tertiary);
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

    <script type="text/babel">
        const { useState, useEffect, useCallback, useMemo } = React;

        // ============================================
        // CONFIGURATION
        // ============================================
        const PROXY_URL = 'https://medref-proxy.jeansimail.workers.dev';
        const USE_PROXY = true;

        // Liste complète des pathologies (90% des maladies occidentales)
        const DISEASES_LIST = [
            // Cardiovasculaire
            { id: 'hta', name: 'Hypertension artérielle', category: 'Cardiovasculaire' },
            { id: 'coronaropathie', name: 'Coronaropathie', category: 'Cardiovasculaire' },
            { id: 'insuffisance-cardiaque', name: 'Insuffisance cardiaque', category: 'Cardiovasculaire' },
            { id: 'fibrillation-auriculaire', name: 'Fibrillation auriculaire', category: 'Cardiovasculaire' },
            { id: 'avc', name: 'AVC ischémique', category: 'Cardiovasculaire' },
            { id: 'aomi', name: 'AOMI', category: 'Cardiovasculaire' },
            { id: 'tvp', name: 'Thrombose veineuse profonde', category: 'Cardiovasculaire' },
            { id: 'embolie-pulmonaire', name: 'Embolie pulmonaire', category: 'Cardiovasculaire' },
            
            // Respiratoire
            { id: 'bpco', name: 'BPCO', category: 'Respiratoire' },
            { id: 'asthme', name: 'Asthme', category: 'Respiratoire' },
            { id: 'pneumonie', name: 'Pneumonie communautaire', category: 'Respiratoire' },
            { id: 'covid19', name: 'COVID-19', category: 'Respiratoire' },
            { id: 'grippe', name: 'Grippe', category: 'Respiratoire' },
            { id: 'apnee-sommeil', name: 'Syndrome d\'apnées du sommeil', category: 'Respiratoire' },
            
            // Métabolique/Endocrinien
            { id: 'diabete-type2', name: 'Diabète de type 2', category: 'Métabolique' },
            { id: 'diabete-type1', name: 'Diabète de type 1', category: 'Métabolique' },
            { id: 'dyslipidemie', name: 'Dyslipidémie', category: 'Métabolique' },
            { id: 'hypothyroidie', name: 'Hypothyroïdie', category: 'Endocrinien' },
            { id: 'hyperthyroidie', name: 'Hyperthyroïdie', category: 'Endocrinien' },
            { id: 'obesite', name: 'Obésité', category: 'Métabolique' },
            { id: 'goutte', name: 'Goutte', category: 'Métabolique' },
            
            // Digestif
            { id: 'rgo', name: 'RGO', category: 'Digestif' },
            { id: 'ulcere-gastrique', name: 'Ulcère gastroduodénal', category: 'Digestif' },
            { id: 'syndrome-intestin-irritable', name: 'Syndrome de l\'intestin irritable', category: 'Digestif' },
            { id: 'mici', name: 'MICI (Crohn/RCH)', category: 'Digestif' },
            { id: 'cirrhose', name: 'Cirrhose', category: 'Digestif' },
            { id: 'hepatite-b', name: 'Hépatite B', category: 'Digestif' },
            { id: 'hepatite-c', name: 'Hépatite C', category: 'Digestif' },
            { id: 'lithiase-biliaire', name: 'Lithiase biliaire', category: 'Digestif' },
            { id: 'pancreatite', name: 'Pancréatite aiguë', category: 'Digestif' },
            
            // Neurologie
            { id: 'migraine', name: 'Migraine', category: 'Neurologie' },
            { id: 'epilepsie', name: 'Épilepsie', category: 'Neurologie' },
            { id: 'parkinson', name: 'Maladie de Parkinson', category: 'Neurologie' },
            { id: 'alzheimer', name: 'Maladie d\'Alzheimer', category: 'Neurologie' },
            { id: 'sep', name: 'Sclérose en plaques', category: 'Neurologie' },
            { id: 'neuropathie-peripherique', name: 'Neuropathie périphérique', category: 'Neurologie' },
            { id: 'meningite', name: 'Méningite bactérienne', category: 'Neurologie' },
            
            // Psychiatrie
            { id: 'depression', name: 'Épisode dépressif majeur', category: 'Psychiatrie' },
            { id: 'trouble-anxieux', name: 'Trouble anxieux généralisé', category: 'Psychiatrie' },
            { id: 'trouble-bipolaire', name: 'Trouble bipolaire', category: 'Psychiatrie' },
            { id: 'schizophrenie', name: 'Schizophrénie', category: 'Psychiatrie' },
            { id: 'toc', name: 'TOC', category: 'Psychiatrie' },
            { id: 'addiction-alcool', name: 'Trouble de l\'usage de l\'alcool', category: 'Psychiatrie' },
            { id: 'addiction-tabac', name: 'Dépendance tabagique', category: 'Psychiatrie' },
            { id: 'trouble-panique', name: 'Trouble panique', category: 'Psychiatrie' },
            
            // Rhumatologie
            { id: 'polyarthrite-rhumatoide', name: 'Polyarthrite rhumatoïde', category: 'Rhumatologie' },
            { id: 'arthrose', name: 'Arthrose', category: 'Rhumatologie' },
            { id: 'spondylarthrite', name: 'Spondylarthrite ankylosante', category: 'Rhumatologie' },
            { id: 'osteoporose', name: 'Ostéoporose', category: 'Rhumatologie' },
            { id: 'fibromyalgie', name: 'Fibromyalgie', category: 'Rhumatologie' },
            { id: 'lupus', name: 'Lupus érythémateux systémique', category: 'Rhumatologie' },
            { id: 'sclerodermie', name: 'Sclérodermie systémique', category: 'Rhumatologie' },
            
            // Néphrologie
            { id: 'irc', name: 'Insuffisance rénale chronique', category: 'Néphrologie' },
            { id: 'infection-urinaire', name: 'Infection urinaire', category: 'Néphrologie' },
            { id: 'lithiase-urinaire', name: 'Lithiase urinaire', category: 'Néphrologie' },
            { id: 'syndrome-nephrotique', name: 'Syndrome néphrotique', category: 'Néphrologie' },
            
            // Dermatologie
            { id: 'eczema', name: 'Dermatite atopique', category: 'Dermatologie' },
            { id: 'psoriasis', name: 'Psoriasis', category: 'Dermatologie' },
            { id: 'acne', name: 'Acné', category: 'Dermatologie' },
            { id: 'melanome', name: 'Mélanome', category: 'Dermatologie' },
            { id: 'urticaire', name: 'Urticaire chronique', category: 'Dermatologie' },
            { id: 'zona', name: 'Zona', category: 'Dermatologie' },
            
            // Infectieux
            { id: 'vih', name: 'VIH/SIDA', category: 'Infectieux' },
            { id: 'chlamydia', name: 'Chlamydiose', category: 'Infectieux' },
            { id: 'tuberculose', name: 'Tuberculose', category: 'Infectieux' },
            { id: 'endocardite', name: 'Endocardite infectieuse', category: 'Infectieux' },
            { id: 'sepsis', name: 'Sepsis', category: 'Infectieux' },
            
            // Oncologie
            { id: 'cancer-sein', name: 'Cancer du sein', category: 'Oncologie' },
            { id: 'cancer-poumon', name: 'Cancer du poumon', category: 'Oncologie' },
            { id: 'cancer-colon', name: 'Cancer colorectal', category: 'Oncologie' },
            { id: 'cancer-prostate', name: 'Cancer de la prostate', category: 'Oncologie' },
            { id: 'lymphome', name: 'Lymphome', category: 'Oncologie' },
            { id: 'leucemie', name: 'Leucémie aiguë', category: 'Oncologie' },
            
            // Hématologie
            { id: 'anemie-ferriprive', name: 'Anémie ferriprive', category: 'Hématologie' },
            { id: 'anemie-b12', name: 'Anémie par carence en B12', category: 'Hématologie' },
            { id: 'hemophilie', name: 'Hémophilie', category: 'Hématologie' },
            { id: 'thrombopenie', name: 'Thrombopénie immune', category: 'Hématologie' },
            
            // Autres
            { id: 'allergie', name: 'Rhinite allergique', category: 'Allergologie' },
            { id: 'anaphylaxie', name: 'Anaphylaxie', category: 'Allergologie' },
        ];

        const CATEGORIES = ['Tous', ...new Set(DISEASES_LIST.map(d => d.category))].sort((a, b) => {
            if (a === 'Tous') return -1;
            if (b === 'Tous') return 1;
            return a.localeCompare(b);
        });

        // ============================================
        // ICONS
        // ============================================
        const Icons = {
            pulse: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 12h-4l-3 9L9 3l-3 9H2"/></svg>,
            search: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="11" cy="11" r="8"/><path d="m21 21-4.35-4.35"/></svg>,
            settings: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z"/><circle cx="12" cy="12" r="3"/></svg>,
            chevronLeft: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m15 18-6-6 6-6"/></svg>,
            refresh: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8"/><path d="M21 3v5h-5"/><path d="M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16"/><path d="M8 16H3v5"/></svg>,
            x: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M18 6 6 18"/><path d="m6 6 12 12"/></svg>,
            info: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><path d="M12 16v-4"/><path d="M12 8h.01"/></svg>,
            chart: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M3 3v18h18"/><path d="m19 9-5 5-4-4-3 3"/></svg>,
            brain: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z"/><path d="M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z"/><path d="M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4"/><path d="M17.599 6.5a3 3 0 0 0 .399-1.375"/><path d="M6.003 5.125A3 3 0 0 0 6.401 6.5"/><path d="M3.477 10.896a4 4 0 0 1 .585-.396"/><path d="M19.938 10.5a4 4 0 0 1 .585.396"/><path d="M6 18a4 4 0 0 1-1.967-.516"/><path d="M19.967 17.484A4 4 0 0 1 18 18"/></svg>,
            activity: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2"/></svg>,
            warning: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3"/><path d="M12 9v4"/><path d="M12 17h.01"/></svg>,
            file: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z"/><path d="M14 2v4a2 2 0 0 0 2 2h4"/></svg>,
            pill: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="m10.5 20.5 10-10a4.95 4.95 0 1 0-7-7l-10 10a4.95 4.95 0 1 0 7 7Z"/><path d="m8.5 8.5 7 7"/></svg>,
            star: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"/></svg>,
            clock: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
            check: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M20 6 9 17l-5-5"/></svg>,
            sparkles: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z"/></svg>,
            database: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><ellipse cx="12" cy="5" rx="9" ry="3"/><path d="M3 5V19A9 3 0 0 0 21 19V5"/><path d="M3 12A9 3 0 0 0 21 12"/></svg>,
            folder: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z"/></svg>,
            sync: <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M21 12a9 9 0 0 0-9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/><path d="M3 12a9 9 0 0 0 9 9 9.75 9.75 0 0 0 6.74-2.74L21 16"/><path d="M16 16h5v5"/></svg>,
        };

        // ============================================
        // MAIN APP
        // ============================================
        function App() {
            // State
            const [apiKey, setApiKey] = useState(() => localStorage.getItem('medref_api_key') || '');
            const [gistToken, setGistToken] = useState(() => localStorage.getItem('medref_gist_token') || '');
            const [gistId, setGistId] = useState(() => localStorage.getItem('medref_gist_id') || '');
            const [diseases, setDiseases] = useState(() => {
                const saved = localStorage.getItem('medref_diseases');
                return saved ? JSON.parse(saved) : {};
            });
            const [selectedDisease, setSelectedDisease] = useState(null);
            const [searchQuery, setSearchQuery] = useState('');
            const [selectedCategory, setSelectedCategory] = useState('Tous');
            const [isSettingsOpen, setIsSettingsOpen] = useState(false);
            const [isLoading, setIsLoading] = useState(false);
            const [loadingMessage, setLoadingMessage] = useState('');
            const [toast, setToast] = useState(null);

            // Persist data
            useEffect(() => {
                localStorage.setItem('medref_diseases', JSON.stringify(diseases));
            }, [diseases]);

            useEffect(() => {
                localStorage.setItem('medref_api_key', apiKey);
            }, [apiKey]);

            useEffect(() => {
                localStorage.setItem('medref_gist_token', gistToken);
            }, [gistToken]);

            useEffect(() => {
                localStorage.setItem('medref_gist_id', gistId);
            }, [gistId]);

            // Toast notification
            const showToast = useCallback((message) => {
                setToast(message);
                setTimeout(() => setToast(null), 3500);
            }, []);

            // API Call
            const callAPI = async (prompt) => {
                const headers = {
                    'Content-Type': 'application/json',
                };

                let url, body;

                if (USE_PROXY) {
                    url = PROXY_URL;
                    body = JSON.stringify({
                        prompt: prompt,
                        apiKey: apiKey
                    });
                } else {
                    url = 'https://api.anthropic.com/v1/messages';
                    headers['x-api-key'] = apiKey;
                    headers['anthropic-version'] = '2023-06-01';
                    headers['anthropic-dangerous-direct-browser-access'] = 'true';
                    body = JSON.stringify({
                        model: 'claude-sonnet-4-20250514',
                        max_tokens: 4000,
                        messages: [{ role: 'user', content: prompt }]
                    });
                }

                const response = await fetch(url, {
                    method: 'POST',
                    headers,
                    body
                });

                if (!response.ok) {
                    const error = await response.text();
                    throw new Error(`API Error ${response.status}: ${error}`);
                }

                const data = await response.json();
                return USE_PROXY ? data.content : data.content[0].text;
            };

            // Generate disease card
            const generateDiseaseCard = async (diseaseInfo) => {
                if (!apiKey) {
                    showToast('⚠️ Configurez votre clé API Grok dans les paramètres');
                    setIsSettingsOpen(true);
                    return;
                }

                setIsLoading(true);
                setLoadingMessage(`Génération de la fiche "${diseaseInfo.name}"...`);

                const prompt = `Tu es un assistant médical expert pour professionnels de santé. Génère une fiche médicale COMPLÈTE et DÉTAILLÉE pour: ${diseaseInfo.name}

RÉPONDS UNIQUEMENT avec un objet JSON valide (pas de texte avant/après, pas de markdown). Structure exacte:

{
    "definition": "Définition précise et complète",
    "epidemiologie": {
        "prevalence": "X% (données occidentales, source)",
        "incidence": "X/100 000/an",
        "frequence": "Rang de fréquence",
        "details": "Sex-ratio, pic d'âge, variations géographiques, évolution temporelle"
    },
    "physiopathologie": {
        "resume": "Résumé en 3-4 phrases des mécanismes clés",
        "mecanismes": [
            "Mécanisme 1 détaillé avec voies moléculaires/cellulaires",
            "Mécanisme 2 détaillé",
            "Mécanisme 3 détaillé",
            "Mécanisme 4 si pertinent"
        ],
        "cascade": "Description complète de la cascade physiopathologique, du facteur déclenchant aux conséquences cliniques"
    },
    "symptomes": {
        "principaux": ["Symptôme 1 avec caractéristiques sémiologiques", "Symptôme 2", "Symptôme 3"],
        "secondaires": ["Symptôme secondaire 1", "Symptôme secondaire 2"],
        "signes_cliniques": ["Signe clinique 1 avec technique d'examen", "Signe 2", "Signe 3"]
    },
    "facteurs_risque": ["FR modifiable 1", "FR modifiable 2", "FR non modifiable 1", "FR non modifiable 2"],
    "diagnostic": {
        "clinique": "Éléments cliniques clés et leur valeur diagnostique",
        "paraclinique": ["Examen 1 + ce qu'on recherche", "Examen 2 + résultats attendus"],
        "criteres": "Critères diagnostiques officiels (DSM, ACR, ESC, etc.) si existants",
        "differentiel": ["Diagnostic différentiel 1", "Diagnostic différentiel 2"]
    },
    "traitement": {
        "premiere_ligne": "Traitement de 1ère intention avec DCI, posologies, durée",
        "alternatives": ["Alternative 1 avec indication", "Alternative 2"],
        "non_medicamenteux": ["RHD 1", "RHD 2"],
        "surveillance": "Paramètres de surveillance, fréquence, objectifs thérapeutiques",
        "urgence": "CAT en urgence si applicable"
    },
    "mnemonique": {
        "acronyme": "ACRONYME mémorable OU phrase mnémotechnique",
        "explication": "Explication lettre par lettre ou mot par mot",
        "astuce": "Astuce clinique supplémentaire pour retenir les points clés"
    },
    "sources": ["Recommandation officielle 1 (année)", "Source 2 (année)", "Source 3"],
    "derniere_maj": "${new Date().toISOString().split('T')[0]}"
}

Utilise les dernières recommandations 2024-2025. Données épidémiologiques pour Europe/Amérique du Nord. Sois exhaustif et précis.`;

                try {
                    const content = await callAPI(prompt);
                    
                    // Parse JSON
                    const jsonMatch = content.match(/\{[\s\S]*\}/);
                    if (jsonMatch) {
                        const diseaseData = JSON.parse(jsonMatch[0]);
                        setDiseases(prev => ({
                            ...prev,
                            [diseaseInfo.id]: {
                                ...diseaseInfo,
                                ...diseaseData,
                                generated: true
                            }
                        }));
                        showToast(`✅ Fiche "${diseaseInfo.name}" générée`);
                    } else {
                        throw new Error('Format de réponse invalide');
                    }
                } catch (error) {
                    console.error('Error:', error);
                    showToast(`❌ Erreur: ${error.message}`);
                } finally {
                    setIsLoading(false);
                    setLoadingMessage('');
                }
            };

            // Sync to Gist
            const syncToGist = async () => {
                if (!gistToken) {
                    showToast('⚠️ Configurez votre token GitHub dans les paramètres');
                    return;
                }

                setIsLoading(true);
                setLoadingMessage('Synchronisation en cours...');

                try {
                    const content = JSON.stringify(diseases, null, 2);
                    
                    if (gistId) {
                        // Update existing gist
                        await fetch(`https://api.github.com/gists/${gistId}`, {
                            method: 'PATCH',
                            headers: {
                                'Authorization': `token ${gistToken}`,
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                files: {
                                    'medref-data.json': { content }
                                }
                            })
                        });
                    } else {
                        // Create new gist
                        const response = await fetch('https://api.github.com/gists', {
                            method: 'POST',
                            headers: {
                                'Authorization': `token ${gistToken}`,
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                description: 'MedRef Pro - Fiches médicales',
                                public: false,
                                files: {
                                    'medref-data.json': { content }
                                }
                            })
                        });
                        const data = await response.json();
                        setGistId(data.id);
                        localStorage.setItem('medref_gist_id', data.id);
                    }
                    
                    showToast('✅ Synchronisé avec GitHub');
                } catch (error) {
                    showToast(`❌ Erreur sync: ${error.message}`);
                } finally {
                    setIsLoading(false);
                    setLoadingMessage('');
                }
            };

            // Load from Gist
            const loadFromGist = async () => {
                if (!gistToken || !gistId) {
                    showToast('⚠️ Configurez GitHub dans les paramètres');
                    return;
                }

                setIsLoading(true);
                setLoadingMessage('Chargement depuis GitHub...');

                try {
                    const response = await fetch(`https://api.github.com/gists/${gistId}`, {
                        headers: {
                            'Authorization': `token ${gistToken}`
                        }
                    });
                    const data = await response.json();
                    const content = data.files['medref-data.json'].content;
                    const loadedDiseases = JSON.parse(content);
                    setDiseases(loadedDiseases);
                    showToast(`✅ ${Object.keys(loadedDiseases).length} fiches chargées`);
                } catch (error) {
                    showToast(`❌ Erreur: ${error.message}`);
                } finally {
                    setIsLoading(false);
                    setLoadingMessage('');
                }
            };

            // Filter diseases
            const filteredDiseases = useMemo(() => {
                return DISEASES_LIST.filter(d => {
                    const matchesSearch = d.name.toLowerCase().includes(searchQuery.toLowerCase()) ||
                        d.category.toLowerCase().includes(searchQuery.toLowerCase());
                    const matchesCategory = selectedCategory === 'Tous' || d.category === selectedCategory;
                    return matchesSearch && matchesCategory;
                });
            }, [searchQuery, selectedCategory]);

            // Stats
            const generatedCount = Object.keys(diseases).filter(k => diseases[k]?.generated).length;
            const totalCount = DISEASES_LIST.length;
            const categoriesCount = CATEGORIES.length - 1;

            return (
                <div className="app">
                    {/* Progress Bar */}
                    <div className={`progress-bar ${isLoading ? 'active' : ''}`}>
                        <div className="progress-bar-inner"></div>
                    </div>

                    {/* Header */}
                    <header className="header">
                        <div className="container">
                            <div className="header-inner">
                                <div className="logo">
                                    <div className="logo-mark">{Icons.pulse}</div>
                                    <div className="logo-text">
                                        <div className="logo-title">MedRef Pro</div>
                                        <div className="logo-subtitle">Fiches médicales IA</div>
                                    </div>
                                </div>
                                <div className="header-actions">
                                    {gistToken && (
                                        <button className="btn-icon" onClick={syncToGist} title="Synchroniser">
                                            {Icons.sync}
                                        </button>
                                    )}
                                    <button className="btn-icon" onClick={() => setIsSettingsOpen(true)} title="Paramètres">
                                        {Icons.settings}
                                    </button>
                                </div>
                            </div>
                        </div>
                    </header>

                    {/* Hero */}
                    <section className="hero">
                        <div className="container">
                            <div className="hero-content">
                                <h1 className="hero-title">
                                    Vos fiches médicales<br/><span>actualisées par IA</span>
                                </h1>
                                <p className="hero-description">
                                    {totalCount} pathologies couvrant 90% des cas en médecine occidentale. 
                                    Générées et mises à jour automatiquement via Grok.
                                </p>
                                <div className="search-wrapper">
                                    <div className="search-bar">
                                        <span className="search-icon">{Icons.search}</span>
                                        <input
                                            type="text"
                                            className="search-input"
                                            placeholder="Rechercher une pathologie..."
                                            value={searchQuery}
                                            onChange={(e) => setSearchQuery(e.target.value)}
                                        />
                                        <span className="search-kbd">⌘K</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    {/* Stats */}
                    <section className="stats-section">
                        <div className="container">
                            <div className="stats-grid">
                                <div className="stat-card">
                                    <div className="stat-icon blue">{Icons.file}</div>
                                    <div className="stat-value">{generatedCount}</div>
                                    <div className="stat-label">Fiches générées</div>
                                </div>
                                <div className="stat-card">
                                    <div className="stat-icon purple">{Icons.database}</div>
                                    <div className="stat-value">{totalCount}</div>
                                    <div className="stat-label">Pathologies</div>
                                </div>
                                <div className="stat-card">
                                    <div className="stat-icon green">{Icons.folder}</div>
                                    <div className="stat-value">{categoriesCount}</div>
                                    <div className="stat-label">Spécialités</div>
                                </div>
                                <div className="stat-card">
                                    <div className="stat-icon orange">{Icons.sparkles}</div>
                                    <div className="stat-value">2025</div>
                                    <div className="stat-label">Données à jour</div>
                                </div>
                            </div>
                        </div>
                    </section>

                    {/* Categories */}
                    <section className="categories-section">
                        <div className="container">
                            <div className="categories-scroll">
                                {CATEGORIES.map(cat => (
                                    <button
                                        key={cat}
                                        className={`category-chip ${selectedCategory === cat ? 'active' : ''}`}
                                        onClick={() => setSelectedCategory(cat)}
                                    >
                                        {cat}
                                    </button>
                                ))}
                            </div>
                        </div>
                    </section>

                    {/* Diseases Grid */}
                    <section className="diseases-section">
                        <div className="container">
                            <div className="section-header">
                                <h2 className="section-title">Pathologies</h2>
                                <span className="section-count">{filteredDiseases.length} résultats</span>
                            </div>
                            <div className="diseases-grid">
                                {filteredDiseases.map(disease => {
                                    const hasData = diseases[disease.id]?.generated;
                                    return (
                                        <div
                                            key={disease.id}
                                            className="disease-card"
                                            onClick={() => {
                                                if (hasData) {
                                                    setSelectedDisease(disease.id);
                                                } else {
                                                    generateDiseaseCard(disease);
                                                }
                                            }}
                                        >
                                            <div className="disease-card-content">
                                                <div className="disease-header">
                                                    <h3 className="disease-name">{disease.name}</h3>
                                                    <span className="disease-badge">{disease.category}</span>
                                                </div>
                                                <p className="disease-preview">
                                                    {hasData 
                                                        ? diseases[disease.id].definition?.substring(0, 120) + '...'
                                                        : 'Cliquez pour générer la fiche médicale complète avec physiopathologie, traitement et mnémotechniques.'
                                                    }
                                                </p>
                                                <div className="disease-footer">
                                                    {hasData && (
                                                        <div className="disease-meta">
                                                            {Icons.clock}
                                                            <span>{diseases[disease.id].derniere_maj}</span>
                                                        </div>
                                                    )}
                                                    <div className={`disease-status ${hasData ? 'generated' : 'pending'}`}>
                                                        <span className="status-dot"></span>
                                                        {hasData ? 'Générée' : 'À générer'}
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    );
                                })}
                            </div>
                        </div>
                    </section>

                    {/* Detail Panel */}
                    <div 
                        className={`detail-overlay ${selectedDisease ? 'open' : ''}`}
                        onClick={() => setSelectedDisease(null)}
                    />
                    <DiseaseDetail
                        disease={selectedDisease ? diseases[selectedDisease] : null}
                        diseaseInfo={DISEASES_LIST.find(d => d.id === selectedDisease)}
                        isOpen={!!selectedDisease}
                        onClose={() => setSelectedDisease(null)}
                        onGenerate={() => {
                            const info = DISEASES_LIST.find(d => d.id === selectedDisease);
                            if (info) generateDiseaseCard(info);
                        }}
                        isLoading={isLoading}
                    />

                    {/* Settings Modal */}
                    <div 
                        className={`settings-overlay ${isSettingsOpen ? 'open' : ''}`}
                        onClick={() => setIsSettingsOpen(false)}
                    />
                    <div className={`settings-modal ${isSettingsOpen ? 'open' : ''}`}>
                        <div className="settings-header">
                            <div className="settings-handle"></div>
                            <h2 className="settings-title">Paramètres</h2>
                            <button className="btn-close" onClick={() => setIsSettingsOpen(false)}>
                                {Icons.x}
                            </button>
                        </div>
                        <div className="settings-body">
                            <div className="setting-group">
                                <h3 className="setting-group-title">API Grok (xAI)</h3>
                                <div className="setting-item">
                                    <div className="setting-item-header">
                                        <span className="setting-label">Clé API</span>
                                        {apiKey && <span className="status-badge success">{Icons.check} Configurée</span>}
                                    </div>
                                    <p className="setting-desc">
                                        Nécessaire pour générer les fiches. Obtenez-la sur console.x.ai
                                    </p>
                                    <input
                                        type="password"
                                        className="input-field"
                                        placeholder="xai-..."
                                        value={apiKey}
                                        onChange={(e) => setApiKey(e.target.value)}
                                    />
                                </div>
                            </div>

                            <div className="setting-group">
                                <h3 className="setting-group-title">Synchronisation GitHub</h3>
                                <div className="setting-item">
                                    <div className="setting-item-header">
                                        <span className="setting-label">Token GitHub</span>
                                        {gistToken && <span className="status-badge success">{Icons.check} Configuré</span>}
                                    </div>
                                    <p className="setting-desc">
                                        Pour sauvegarder vos fiches entre appareils. Créez un token sur github.com/settings/tokens avec le scope "gist".
                                    </p>
                                    <input
                                        type="password"
                                        className="input-field"
                                        placeholder="ghp_..."
                                        value={gistToken}
                                        onChange={(e) => setGistToken(e.target.value)}
                                    />
                                </div>
                                <div className="setting-item">
                                    <div className="setting-item-header">
                                        <span className="setting-label">Gist ID</span>
                                    </div>
                                    <p className="setting-desc">
                                        Laissez vide pour créer un nouveau Gist, ou entrez l'ID d'un Gist existant.
                                    </p>
                                    <input
                                        type="text"
                                        className="input-field"
                                        placeholder="(auto-généré)"
                                        value={gistId}
                                        onChange={(e) => setGistId(e.target.value)}
                                    />
                                </div>
                                {gistToken && gistId && (
                                    <button 
                                        className="btn-primary" 
                                        style={{marginTop: '12px'}}
                                        onClick={loadFromGist}
                                    >
                                        Charger depuis GitHub
                                    </button>
                                )}
                            </div>

                            <div className="setting-group">
                                <h3 className="setting-group-title">Données</h3>
                                <div className="setting-item">
                                    <span className="setting-label">{generatedCount} fiches générées</span>
                                    <p className="setting-desc">
                                        sur {totalCount} pathologies disponibles
                                    </p>
                                </div>
                            </div>
                        </div>
                        <div className="settings-footer">
                            <button 
                                className="btn-primary"
                                onClick={() => {
                                    setIsSettingsOpen(false);
                                    showToast('✅ Paramètres enregistrés');
                                }}
                            >
                                Enregistrer
                            </button>
                        </div>
                    </div>

                    {/* Loading Overlay */}
                    <div className={`loading-overlay ${isLoading ? 'active' : ''}`}>
                        <div className="loading-spinner"></div>
                        <div className="loading-text">{loadingMessage || 'Chargement...'}</div>
                        <div className="loading-subtext">Grok analyse les données médicales</div>
                    </div>

                    {/* Toast */}
                    <div className={`toast ${toast ? 'show' : ''}`}>{toast}</div>
                </div>
            );
        }

        // ============================================
        // DISEASE DETAIL COMPONENT
        // ============================================
        function DiseaseDetail({ disease, diseaseInfo, isOpen, onClose, onGenerate, isLoading }) {
            if (!diseaseInfo) return null;

            return (
                <div className={`detail-panel ${isOpen ? 'open' : ''}`}>
                    <div className="detail-header">
                        <div className="detail-nav">
                            <button className="btn-back" onClick={onClose}>
                                {Icons.chevronLeft}
                                Retour
                            </button>
                            {disease?.generated && (
                                <button className="btn-refresh" onClick={onGenerate} disabled={isLoading}>
                                    {Icons.refresh}
                                    Actualiser
                                </button>
                            )}
                        </div>
                        <h1 className="detail-title">{diseaseInfo.name}</h1>
                        <span className="detail-badge">{diseaseInfo.category}</span>
                    </div>

                    <div className="detail-content">
                        {disease?.generated ? (
                            <>
                                {/* Update Info */}
                                <div className="update-info">
                                    <span className="dot"></span>
                                    Dernière mise à jour: {disease.derniere_maj}
                                </div>

                                {/* Definition */}
                                <div className="info-card blue">
                                    <div className="info-card-header">
                                        <div className="info-card-icon blue">{Icons.info}</div>
                                        <span className="info-card-title">Définition</span>
                                    </div>
                                    <div className="info-card-body">
                                        {disease.definition}
                                    </div>
                                </div>

                                {/* Epidemiology */}
                                <div className="info-card green">
                                    <div className="info-card-header">
                                        <div className="info-card-icon green">{Icons.chart}</div>
                                        <span className="info-card-title">Épidémiologie</span>
                                    </div>
                                    <div className="epi-grid">
                                        <div className="epi-item">
                                            <div className="epi-value">{disease.epidemiologie?.prevalence?.split(' ')[0]}</div>
                                            <div className="epi-label">Prévalence</div>
                                        </div>
                                        <div className="epi-item">
                                            <div className="epi-value">{disease.epidemiologie?.incidence?.split('/')[0]}</div>
                                            <div className="epi-label">Incidence</div>
                                        </div>
                                        <div className="epi-item">
                                            <div className="epi-value">{disease.epidemiologie?.frequence?.split(' ')[0]}</div>
                                            <div className="epi-label">Fréquence</div>
                                        </div>
                                    </div>
                                    <div className="info-card-body">
                                        {disease.epidemiologie?.details}
                                    </div>
                                </div>

                                {/* Physiopathology */}
                                <div className="info-card purple">
                                    <div className="info-card-header">
                                        <div className="info-card-icon purple">{Icons.brain}</div>
                                        <span className="info-card-title">Physiopathologie</span>
                                    </div>
                                    <div className="info-card-body">
                                        <p><strong>{disease.physiopathologie?.resume}</strong></p>
                                        <ul>
                                            {disease.physiopathologie?.mecanismes?.map((m, i) => (
                                                <li key={i}>{m}</li>
                                            ))}
                                        </ul>
                                        <div className="highlight-box">
                                            <strong>Cascade physiopathologique:</strong><br/>
                                            {disease.physiopathologie?.cascade}
                                        </div>
                                    </div>
                                </div>

                                {/* Symptoms */}
                                <div className="info-card orange">
                                    <div className="info-card-header">
                                        <div className="info-card-icon orange">{Icons.activity}</div>
                                        <span className="info-card-title">Symptômes & Signes</span>
                                    </div>
                                    <div className="info-card-body">
                                        <p><strong>Principaux:</strong></p>
                                        <ul>
                                            {disease.symptomes?.principaux?.map((s, i) => (
                                                <li key={i}>{s}</li>
                                            ))}
                                        </ul>
                                        <p><strong>Secondaires:</strong></p>
                                        <ul>
                                            {disease.symptomes?.secondaires?.map((s, i) => (
                                                <li key={i}>{s}</li>
                                            ))}
                                        </ul>
                                        <p><strong>Signes cliniques:</strong></p>
                                        <ul>
                                            {disease.symptomes?.signes_cliniques?.map((s, i) => (
                                                <li key={i}>{s}</li>
                                            ))}
                                        </ul>
                                    </div>
                                </div>

                                {/* Risk Factors */}
                                <div className="info-card orange">
                                    <div className="info-card-header">
                                        <div className="info-card-icon orange">{Icons.warning}</div>
                                        <span className="info-card-title">Facteurs de risque</span>
                                    </div>
                                    <div className="info-card-body">
                                        <ul>
                                            {disease.facteurs_risque?.map((f, i) => (
                                                <li key={i}>{f}</li>
                                            ))}
                                        </ul>
                                    </div>
                                </div>

                                {/* Diagnosis */}
                                <div className="info-card blue">
                                    <div className="info-card-header">
                                        <div className="info-card-icon blue">{Icons.file}</div>
                                        <span className="info-card-title">Diagnostic</span>
                                    </div>
                                    <div className="info-card-body">
                                        <p><strong>Clinique:</strong> {disease.diagnostic?.clinique}</p>
                                        <p><strong>Paraclinique:</strong></p>
                                        <ul>
                                            {disease.diagnostic?.paraclinique?.map((e, i) => (
                                                <li key={i}>{e}</li>
                                            ))}
                                        </ul>
                                        {disease.diagnostic?.criteres && (
                                            <div className="highlight-box">
                                                <strong>Critères diagnostiques:</strong><br/>
                                                {disease.diagnostic.criteres}
                                            </div>
                                        )}
                                        {disease.diagnostic?.differentiel && (
                                            <>
                                                <p><strong>Diagnostics différentiels:</strong></p>
                                                <ul>
                                                    {disease.diagnostic.differentiel.map((d, i) => (
                                                        <li key={i}>{d}</li>
                                                    ))}
                                                </ul>
                                            </>
                                        )}
                                    </div>
                                </div>

                                {/* Treatment */}
                                <div className="info-card green">
                                    <div className="info-card-header">
                                        <div className="info-card-icon green">{Icons.pill}</div>
                                        <span className="info-card-title">Traitement</span>
                                    </div>
                                    <div className="info-card-body">
                                        <p><strong>1ère ligne:</strong> {disease.traitement?.premiere_ligne}</p>
                                        <p><strong>Alternatives:</strong></p>
                                        <ul>
                                            {disease.traitement?.alternatives?.map((a, i) => (
                                                <li key={i}>{a}</li>
                                            ))}
                                        </ul>
                                        <p><strong>Non médicamenteux:</strong></p>
                                        <ul>
                                            {disease.traitement?.non_medicamenteux?.map((m, i) => (
                                                <li key={i}>{m}</li>
                                            ))}
                                        </ul>
                                        <div className="highlight-box">
                                            <strong>Surveillance:</strong><br/>
                                            {disease.traitement?.surveillance}
                                        </div>
                                        {disease.traitement?.urgence && (
                                            <div className="highlight-box" style={{borderLeft: '3px solid var(--accent-warm)'}}>
                                                <strong>⚠️ Urgence:</strong><br/>
                                                {disease.traitement.urgence}
                                            </div>
                                        )}
                                    </div>
                                </div>

                                {/* Mnemonic */}
                                <div className="info-card rose">
                                    <div className="info-card-header">
                                        <div className="info-card-icon rose">{Icons.star}</div>
                                        <span className="info-card-title">Mnémotechnique</span>
                                    </div>
                                    <div className="mnemonic-box">
                                        <div className="mnemonic-label">
                                            {Icons.sparkles} À retenir
                                        </div>
                                        <div className="mnemonic-text">
                                            {disease.mnemonique?.acronyme}
                                        </div>
                                        <div className="mnemonic-explanation">
                                            {disease.mnemonique?.explication}
                                        </div>
                                        {disease.mnemonique?.astuce && (
                                            <div className="mnemonic-explanation" style={{marginTop: '12px', fontStyle: 'italic'}}>
                                                💡 {disease.mnemonique.astuce}
                                            </div>
                                        )}
                                    </div>
                                </div>

                                {/* Sources */}
                                <div className="sources-list">
                                    <div className="sources-title">Sources & Références</div>
                                    {disease.sources?.map((s, i) => (
                                        <div key={i} className="source-item">{s}</div>
                                    ))}
                                </div>
                            </>
                        ) : (
                            <div className="empty-state">
                                <div className="empty-state-icon">{Icons.file}</div>
                                <h3 className="empty-state-title">Fiche non générée</h3>
                                <p className="empty-state-desc">
                                    Générez cette fiche pour accéder à la définition, physiopathologie, traitement et mnémotechniques.
                                </p>
                                <button 
                                    className="btn-generate"
                                    onClick={onGenerate}
                                    disabled={isLoading}
                                >
                                    {Icons.sparkles}
                                    {isLoading ? 'Génération...' : 'Générer la fiche'}
                                </button>
                            </div>
                        )}
                    </div>
                </div>
            );
        }

        // Render App
        ReactDOM.createRoot(document.getElementById('root')).render(<App />);
    </script>
</body>
</html>
